@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] Chính sách</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

    <style>
        /* === Reset/Base Styles === */
        * { margin:0; padding:0; box-sizing:border-box; }

        :root{
            --bg-be: #f5f5dc; 
            --box-bg: #fffaf0; 
            --text-dark: #4b2e1e; /* Nâu đậm cho tiêu đề */
            --text-sub: #3e2f25; /* Nâu vừa cho nội dung */
            --border-color: #e8e0d3;
            --shadow: 0 6px 20px rgba(0,0,0,0.06);

            --hover-bg: #c0392b; 
            --hover-text: #f5f5dc; 

            --accent-1: #d2b48c; 
            --accent-2: #e9d8b7; 
        }

        /* === Font Setup === */
        @@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&family=Quicksand:wght@400;500;600&display=swap');
        
        body{
            font-family: 'Quicksand', sans-serif;
            font-weight: 500;
            letter-spacing: 0.2px;
            color: var(--text-sub);
            background: var(--bg-be);
            min-height:100vh;
            line-height:1.6;
        }

        /* Tiêu đề lớn – dùng Poppins */
        h1, h2, h3, .section h2, .privacy-title {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            letter-spacing: 0.4px;
            color: var(--text-dark); 
        }

        /* Đoạn văn & danh sách */
        .section p,
        .section li {
            font-family: 'Quicksand', sans-serif;
            font-weight: 500;
            color: var(--text-sub);
            line-height: 1.75;
            font-size: 1.05rem;
        }

        /* Làm đậm tiêu đề phụ và mục nổi bật */
        .section h3,
        .accordion-header h3 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            color: #5a3b2e;
        }

        /* === Header/Hero Styles === */
        .header {
            width: 100%;
            background: linear-gradient(180deg, rgba(250,245,235,1) 0%, rgba(245,240,226,1) 100%);
            padding: 36px 20px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.04);
            border-radius: 10px;
            margin-bottom: 28px;
            overflow: hidden;
        }
        
        .header-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 28px;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            flex: 1 1 60%;
            min-width: 280px;
        }
        
        .privacy-subtitle {
            margin: 0 0 10px 0;
            color: #6b4c3b;
            font-size: 21px;
            max-width: 780px;
            font-style: italic;
        }
        
        .privacy-title {
            display: flex;
            align-items: center;
            justify-content: left ;
            gap: 12px;
            font-size: 2rem;
            font-weight: bold;
            color: #6b4226; 
            margin: 20px 0;
        }

        .privacy-title i {
            font-size: 2.2rem;
            color: #6b4226;
            transition: transform 0.3s ease, color 0.3s ease;
            cursor: pointer;
        }

        .privacy-title i:hover {
            transform: scale(1.2) rotate(-5deg);
            color: var(--hover-bg); 
        }

        .header-ctas {
            margin-top: 18px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        .btn-hero {
            background: #d4b58a; 
            color: #432d20;
            padding: 10px 16px;
            border-radius: 999px; 
            text-decoration: none;
            font-weight: 600;
            box-shadow: 0 6px 14px rgba(0,0,0,0.08);
            transition: transform .16s ease, box-shadow .16s ease, background .16s ease;
        }
        .btn-hero:hover { transform: translateY(-3px); background: #c49a65; }
        
        .header-right {
            flex: 0 0 360px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header-illustration {
            width: 100%;
            max-width: 360px;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 18px 40px rgba(0,0,0,0.08);
            object-fit: cover;
            transition: transform .25s ease, filter .25s ease;
        }
        .header-illustration:hover { transform: translateY(-4px) scale(1.02); }


        /* === Layout Container & Main Content === */
        .container{
            max-width:1200px;
            margin:0 auto;
            padding: 0 1.25rem 3rem;
            display:flex;
            gap:1.75rem;
            align-items:flex-start;
        }
        
        .sidebar{
            position:sticky;
            top:1.5rem;
            width:280px;
            background:var(--box-bg);
            border-radius:12px;
            padding:1.2rem;
            box-shadow: var(--shadow);
            border:1px solid var(--border-color);
            flex-shrink:0;
        }
        .sidebar h3{ font-size:1.05rem; margin-bottom:0.75rem; color:var(--text-dark); font-weight:700; }
        .nav-list{ list-style:none; }
        .nav-list li{ margin-bottom:0.25rem; }
        .nav-list a{
            display:flex; align-items:center; gap:0.75rem;
            padding:0.65rem 0.9rem;
            color:var(--text-dark);
            text-decoration:none;
            border-radius:8px;
            transition: all .22s ease;
            font-size:0.95rem;
            background:transparent;
        }
        /* Cập nhật selector để phù hợp với Font Awesome icon */
        .nav-list a .nav-icon,
        .nav-list a i.fa-solid { 
            font-size:1.1rem; 
            opacity:0.9;
            color: var(--text-dark); /* Đảm bảo màu mặc định là màu tối */
        }
        
        .nav-list a:hover,
        .nav-list a.active{
            background: var(--hover-bg); 
            color: var(--hover-text); 
            transform: translateX(6px);
        }
        /* Khi hover/active, đổi màu icon thành màu be/text hover */
        .nav-list a:hover .nav-icon,
        .nav-list a.active .nav-icon,
        .nav-list a:hover i.fa-solid,
        .nav-list a.active i.fa-solid { color: var(--hover-text); }


        .main-content{
            flex:1;
            background:var(--box-bg);
            border-radius:12px;
            padding:2rem;
            box-shadow: var(--shadow);
            border:1px solid var(--border-color);
        }

        .section{ margin-bottom:2.5rem; opacity:0; transform:translateY(18px); transition: all .5s ease; }
        .section.visible{ opacity:1; transform:translateY(0); }
        
        .section h2{
            font-size:1.5rem; margin-bottom:0.6rem; color:var(--text-dark); position:relative; padding-bottom:0.4rem; font-weight:700;
        }
        .section h2::after{ content:""; position:absolute; left:0; bottom:0; width:48px; height:3px; background:var(--accent-1); border-radius:2px; }

        .info-box{
            background: #fff8e1; /* Nền vàng nhạt */
            border-left: 5px solid #d4b58a; /* Viền be */
            padding: 1rem 1.2rem;
            margin: 1.5rem 0;
            border-radius: 6px;
        }
        .info-box p {
            margin: 0;
            font-size: 1rem;
            color: #5a4635;
        }

        /* === Accordion Styles === */
        .accordion{ margin-top:1rem; }
        .accordion-item{
            border:1px solid var(--border-color);
            border-radius:10px; margin-bottom:0.85rem; overflow:hidden; transition: box-shadow .2s ease;
            background:var(--box-bg);
        }
        .accordion-item:hover{ box-shadow: 0 8px 18px rgba(0,0,0,0.06); }
        .accordion-header{
            padding:1rem; display:flex; justify-content:space-between; align-items:center; cursor:pointer; background:transparent;
        }
        .accordion-header h3{ font-size:1rem; color:var(--text-dark); margin:0; font-weight:600; }
        .accordion-icon{
            width:34px; height:34px; border-radius:50%; background:var(--accent-2); color:var(--text-dark); display:flex; align-items:center; justify-content:center;
            transition: transform .22s ease, background .22s ease;
        }
        .accordion-item.active .accordion-icon{ transform: rotate(45deg); background:var(--accent-1); color:var(--box-bg); }
        .accordion-content{ max-height:0; overflow:hidden; transition:max-height .35s ease, padding .35s ease; padding:0 1rem; }
        .accordion-item.active .accordion-content{ max-height:800px; padding:1rem; }
        .accordion-content ul { padding-left: 20px; }


        /* === Progress Bar === */
        .progress-bar{ position:fixed; top:0; left:0; height:4px; width:0; background:var(--hover-bg); z-index:9999; transition:width .08s linear; }

        /* === Responsive === */
        @@media (max-width:968px){
            .header-inner { flex-direction: column; gap: 18px; text-align: center; }
            .header-right { order: -1; } 
            .privacy-title { font-size: 28px; justify-content: center; }
            .header-illustration { max-width: 260px; }
            .header-left { width: 100%; }
            .container{ flex-direction:column; padding:0 1rem; }
            .sidebar{ position:relative; width:100%; margin-bottom:1rem; top:0; }
            .nav-list{ display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:0.5rem; }
            .main-content{ padding:1rem; }
        }

        @@media (max-width:640px){
            .header{ padding:1.8rem 1rem; }
            .privacy-title { font-size: 1.6rem; }
            .privacy-subtitle{ font-size:0.95rem; }
            .header-illustration{ max-width: 200px; }
            .sidebar{ padding:1rem; }
            .nav-list a{ padding:0.6rem; font-size:0.92rem; }
        }
    </style>
</head>

<body>
    <div class="progress-bar" id="progressBar"></div>

    <header class="header">
        <div class="header-inner">
            <div class="header-left">
                <h1 class="privacy-title">
                    <i class="fa-solid fa-mug-saucer drink-icon"></i>
                    <span>Buble Tea's Privacy Policy</span>
                    <i class="fa-solid fa-file-contract policy-icon"></i>
                </h1>

                <p class="privacy-subtitle">
                    Quyền riêng tư của bạn rất quan trọng với chúng tôi. Tìm hiểu cách chúng tôi bảo vệ và tôn trọng dữ liệu của bạn.
                </p>

                <div class="header-ctas">
                    <a asp-controller="Home" asp-action="Index" class="btn-hero">Quay về trang chủ</a>
                </div>
            </div>

            <div class="header-right" aria-hidden="true">
                <img src="/img/BublePrivacy.png" alt="Privacy illustration" class="header-illustration">
            </div>
        </div>
    </header>


    <div class="container">
        <aside class="sidebar" aria-label="Mục lục chính sách bảo mật">
            <h3>Mục Lục</h3>
            <ul class="nav-list">
                <li><a href="#introduction" class="nav-link">
                        <i class="fa-solid fa-clipboard-list nav-icon"></i> <span>Giới thiệu</span>
                    </a></li>
                <li><a href="#data-collection" class="nav-link">
                        <i class="fa-solid fa-database nav-icon"></i> <span>Thu Thập Dữ Liệu</span>
                    </a></li>
                <li><a href="#cookies" class="nav-link">
                        <i class="fa-solid fa-cookie-bite nav-icon"></i> <span>Cookies & Theo Dõi</span>
                    </a></li>
                <li><a href="#data-usage" class="nav-link">
                        <i class="fa-solid fa-chart-line nav-icon"></i> <span>Cách Chúng Tôi Sử Dụng Dữ Liệu</span>
                    </a></li>
                <li><a href="#security" class="nav-link">
                        <i class="fa-solid fa-lock nav-icon"></i> <span>Bảo Mật</span>
                    </a></li>
                <li><a href="#user-rights" class="nav-link">
                        <i class="fa-solid fa-user-check nav-icon"></i> <span>Quyền Của Bạn</span>
                    </a></li>
                <li><a href="#contact" class="nav-link">
                        <i class="fa-solid fa-envelope nav-icon"></i> <span>Liên Hệ</span>
                    </a></li>
            </ul>
        </aside>

        <main class="main-content" role="main">
            <section id="introduction" class="section">
                <h2>Giới thiệu</h2>
                <p>Chào mừng bạn đến với Chính sách Bảo mật của Buble Tea. Quyền riêng tư của bạn rất quan trọng đối với
                    chúng tôi. Chính sách này mô tả cách chúng tôi thu thập, sử dụng và bảo vệ thông tin cá nhân khi bạn
                    sử dụng dịch vụ.</p>
                <div class="info-box">
                    <p><strong>Quan trọng:</strong> Khi sử dụng dịch vụ của chúng tôi, bạn đồng ý cho phép chúng tôi thu
                        thập và sử dụng thông tin theo chính sách này.</p>
                </div>
                <p>Chính sách này áp dụng cho tất cả thông tin thu thập thông qua website và các dịch vụ liên quan.</p>
            </section>
            <hr>

            <section id="data-collection" class="section">
                <h2>Thu thập dữ liệu</h2>
                <p>Chúng tôi thu thập các loại thông tin khác nhau để cung cấp và cải thiện dịch vụ:</p>

                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Thông tin cá nhân</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Chúng tôi có thể thu thập thông tin cá nhân mà bạn cung cấp tự nguyện, bao gồm:</p>
                            <ul>
                                <li>Họ tên và thông tin liên hệ (email, số điện thoại)</li>
                                <li>Thông tin đăng nhập (tên tài khoản, mật khẩu)</li>
                                <li>Thông tin thanh toán (khi bạn mua hàng)</li>
                                <li>Thông tin hồ sơ và sở thích</li>
                                <li>Lịch sử trao đổi với bộ phận hỗ trợ</li>
                            </ul>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Dữ liệu sử dụng</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Chúng tôi tự động thu thập một số thông tin khi bạn sử dụng dịch vụ:</p>
                            <ul>
                                <li>Địa chỉ IP và thông tin thiết bị</li>
                                <li>Loại và phiên bản trình duyệt</li>
                                <li>Trang đã truy cập và thời gian trên trang</li>
                                <li>Trang giới thiệu (referrer)</li>
                                <li>Hệ điều hành và nền tảng</li>
                            </ul>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Dữ liệu vị trí</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Với sự cho phép của bạn, chúng tôi có thể thu thập dữ liệu vị trí bằng:</p>
                            <ul>
                                <li>GPS và cảm biến thiết bị</li>
                                <li>Xác định vị trí dựa trên địa chỉ IP</li>
                                <li>Thông tin Wi-Fi / trạm thu phát</li>
                            </ul>
                            <p>Bạn có thể tắt dịch vụ vị trí qua cài đặt thiết bị bất kỳ lúc nào.</p>
                        </div>
                    </div>
                </div>
            </section>
            <hr>

            <section id="cookies" class="section">
                <h2>Cookie &amp; Công nghệ theo dõi</h2>
                <p>Chúng tôi sử dụng cookie và công nghệ tương tự để theo dõi hoạt động trên dịch vụ và lưu một số thông
                    tin. Cookie là các tệp dữ liệu nhỏ được gửi tới trình duyệt và lưu trên thiết bị của bạn.</p>

                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Cookie thiết yếu</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Cookie thiết yếu cần thiết để website hoạt động đúng chức năng (ví dụ: điều hướng trang,
                                truy cập khu vực bảo mật).</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Cookie phân tích</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Cookie phân tích giúp chúng tôi hiểu cách người dùng tương tác với website một cách ẩn
                                danh, hỗ trợ cải thiện trải nghiệm.</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Cookie tiếp thị</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Cookie tiếp thị được sử dụng để hiển thị quảng cáo phù hợp với sở thích của bạn trên các
                                trang web khác.</p>
                        </div>
                    </div>
                </div>
            </section>
            <hr>

            <section id="data-usage" class="section">
                <h2>Cách chúng tôi sử dụng dữ liệu</h2>
                <p>Chúng tôi sử dụng dữ liệu để:</p>
                <ul>
                    <li>Cung cấp và duy trì dịch vụ</li>
                    <li>Thông báo về thay đổi dịch vụ</li>
                    <li>Hỗ trợ khách hàng và trả lời thắc mắc</li>
                    <li>Phân tích và cải thiện dịch vụ</li>
                    <li>Giám sát hiệu năng và xử lý vấn đề kỹ thuật</li>
                    <li>Cá nhân hóa nội dung và đề xuất</li>
                    <li>Gửi thông tin khuyến mãi (khi bạn đồng ý)</li>
                </ul>

                <div class="info-box">
                    <p><strong>Lưu ý:</strong> Chúng tôi cam kết không bán dữ liệu cá nhân của bạn cho bên thứ ba. Thông
                        tin chỉ được sử dụng nhằm nâng cao trải nghiệm sử dụng dịch vụ.</p>
                </div>
            </section>
            <hr>

            <section id="security" class="section">
                <h2>Bảo mật dữ liệu</h2>
                <p>An toàn dữ liệu của bạn là ưu tiên của chúng tôi. Chúng tôi áp dụng các biện pháp tiêu chuẩn ngành để
                    bảo vệ thông tin cá nhân:</p>

                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Mã hóa & An ninh mạng</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Chúng tôi sử dụng giao thức <strong>SSL/TLS</strong> để mã hóa việc truyền dữ liệu. Dữ liệu
                                nhạy cảm được lưu trữ dưới dạng mã hóa (encryption at rest).</p>
                        </div>
                    </div>


                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Kiểm soát truy cập</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Quyền truy cập dữ liệu chỉ được cấp cho nhân sự có thẩm quyền. Chúng tôi áp dụng các cơ
                                chế xác thực và kiểm soát chặt chẽ.</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Kiểm tra định kỳ</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Chúng tôi tiến hành đánh giá bảo mật và quét lỗ hổng định kỳ để phát hiện và xử lý rủi ro
                                kịp thời.</p>
                        </div>
                    </div>
                </div>

                <p style="margin-top:1.5rem;">Dù nỗ lực bảo vệ, không phương thức truyền tải hay lưu trữ điện tử nào an
                    toàn tuyệt đối. Chúng tôi không thể đảm bảo 100% nhưng cam kết giảm thiểu rủi ro tối đa.</p>
            </section>
            <hr>

            <section id="user-rights" class="section">
                <h2>Quyền riêng tư của bạn</h2>
                <p>Bạn có một số quyền liên quan đến dữ liệu cá nhân. Tùy theo nơi bạn sinh sống, các quyền có thể bao
                    gồm:</p>

                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Quyền truy cập</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Bạn có quyền yêu cầu sao chép dữ liệu cá nhân mà chúng tôi lưu giữ. Trong trường hợp yêu
                                cầu quá lớn, chúng tôi có thể tính phí hợp lý.</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Quyền chỉnh sửa</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Bạn có quyền yêu cầu sửa thông tin không chính xác hoặc bổ sung thông tin thiếu.</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Quyền xóa</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Bạn có quyền yêu cầu xóa dữ liệu cá nhân trong một số trường hợp (quyền được quên).</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Quyền hạn chế xử lý</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Bạn có thể yêu cầu hạn chế xử lý dữ liệu trong một số điều kiện nhất định.</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Quyền chuyển dữ liệu</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Bạn có quyền yêu cầu chuyển dữ liệu mà chúng tôi đã thu thập sang tổ chức khác, dưới một
                                số điều kiện.</p>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <div class="accordion-header" role="button" tabindex="0">
                            <h3>Quyền phản đối</h3>
                            <div class="accordion-icon">+</div>
                        </div>
                        <div class="accordion-content">
                            <p>Bạn có quyền phản đối việc chúng tôi xử lý dữ liệu của bạn trong một số trường hợp, đặc
                                biệt là tiếp thị trực tiếp.</p>
                        </div>
                    </div>
                </div>

                <p style="margin-top:1.5rem;">Để thực hiện quyền của bạn, vui lòng liên hệ theo thông tin ở phần Liên hệ
                    bên dưới.</p>
            </section>
            <hr>

            <section id="contact" class="section">
                <h2>Liên hệ</h2>
                <p>Nếu bạn có câu hỏi về Chính sách Bảo mật hoặc cách chúng tôi xử lý dữ liệu, bạn có thể chuyển sang
                    phần liên hệ bằng cách bấm vào nút liên hệ bên dưới:</p>
                <div class="header-ctas">
                    <a asp-controller="Home" asp-action="Contact" class="btn-hero">Liên Hệ</a>
                </div>

            </section>
        </main>
    </div>

    <script>
        // === Progress Bar (JS) ===
        const progressBar = document.getElementById('progressBar');
        const mainContent = document.querySelector('.main-content');
        
        // Cập nhật thanh tiến trình dựa trên vị trí cuộn
        function updateProgressBar() {
            const mainRect = mainContent.getBoundingClientRect();
            const totalHeight = mainContent.scrollHeight - mainContent.clientHeight;
            let scrolled = window.scrollY - mainRect.top + mainContent.scrollTop;
            
            // Xử lý khi cuộn ngoài phạm vi chính
            if (scrolled < 0) scrolled = 0;
            if (scrolled > totalHeight) scrolled = totalHeight;

            const progress = (scrolled / totalHeight) * 100;
            progressBar.style.width = progress + '%';
        }

        // === Sidebar & Section Visibility (JS) ===
        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.nav-link');
        const main = document.querySelector('main');
        let currentActiveSection = '';

        function checkSectionVisibility() {
            // Hiển thị section khi cuộn vào tầm nhìn
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const isVisible = (rect.top <= window.innerHeight * 0.8) && (rect.bottom >= 0);
                if (isVisible) {
                    section.classList.add('visible');
                } else {
                    section.classList.remove('visible');
                }

                // Xác định section đang active cho sidebar
                // Nếu section hiện tại đang ở trên cùng (hoặc sắp chạm top), cập nhật active
                if (rect.top <= 100 && rect.bottom > 100) {
                    currentActiveSection = section.id;
                }
            });

            // Cập nhật active link
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').substring(1) === currentActiveSection) {
                    link.classList.add('active');
                }
            });
        }

        // === Accordion (JS) ===
        const accordionHeaders = document.querySelectorAll('.accordion-header');

        accordionHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const item = header.parentElement;
                const content = item.querySelector('.accordion-content');
                
                // Đóng/Mở toggle
                item.classList.toggle('active');
            });
            
            // Hỗ trợ Enter/Space cho mục có role="button" và tabindex="0"
            header.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    header.click();
                }
            });
        });


        // Listeners
        window.addEventListener('scroll', () => {
            updateProgressBar();
            checkSectionVisibility();
        });
        window.addEventListener('resize', updateProgressBar);
        document.addEventListener('DOMContentLoaded', () => {
            updateProgressBar();
            checkSectionVisibility();
        });
    </script>
</body>

</html>