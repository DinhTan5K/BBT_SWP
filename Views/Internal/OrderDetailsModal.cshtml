@model start.Models.Order
<link rel="stylesheet" href="~/css/internal.css" asp-append-version="true" />
<div class="modal-overlay">
    <div class="modal-content">
        <button class="close-modal" type="button">&times;</button>

        <h2>Chi tiết đơn hàng: @Model.OrderCode</h2>
        <hr />

        <div class="customer-info">
            <p><strong>Khách hàng:</strong> @Model.Customer?.Name</p>
            <p><strong>Địa chỉ:</strong>
                @Model.Address
                @if (!string.IsNullOrWhiteSpace(Model.DetailAddress))
                {
                    <span>, @Model.DetailAddress</span>
                }
            </p>
        </div>

        <table class="order-table">
            <thead>
                <tr>
                    <th>Sản phẩm</th>
                    <th>Size</th>
                    <th>Đơn giá</th>
                    <th>Số lượng</th>
                    <th>Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.OrderDetails)
                {
                    decimal unit = item.UnitPrice; // UnitPrice là decimal (không nullable) theo code của bạn
                    decimal thanhTien = unit * item.Quantity;
                    <tr>
                        <td>@item.Product?.ProductName</td>
                        <td>@item.ProductSize?.Size</td>
                        <td>@unit.ToString("C")</td>
                        <td>@item.Quantity</td>
                        <td>@thanhTien.ToString("C")</td>
                    </tr>
                }
            </tbody>
        </table>

        <div class="summary">
            <p><strong>Phí ship:</strong> @(Model.ShippingFee.ToString("C"))</p>

            @{
                decimal itemsTotal = Model.OrderDetails.Sum(od => od.UnitPrice * od.Quantity);
                decimal grandTotal = itemsTotal + Model.ShippingFee;
            }
            <p><strong>Tổng đơn:</strong> @grandTotal.ToString("C")</p>
        </div>

        <form method="post" asp-action="ConfirmOrder" asp-controller="Internal" style="margin-top: 15px;">
            <input type="hidden" name="id" value="@Model.OrderID" />
            <button type="submit" class="confirm-btn-rounded"> Xác nhận đơn</button>
        </form>
    </div>
</div>