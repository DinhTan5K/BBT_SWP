@model Customer
@{
    ViewData["Title"] = "Profile";

    var avatarUrl = string.IsNullOrEmpty(Model.ProfileImagePath)
    ? Url.Content("~/img/logo1.png")
    : Url.Content(Model.ProfileImagePath);
}


<link rel="stylesheet" href="/css/profile.css" />


<div class="profile-container">
    <h2>@ViewData["Title"]</h2>
    @if (TempData["SuccessMessage"] != null)
{
    <div id="successToast" class="alert alert-success text-center" role="alert"
         style="position: fixed; top: 70px; right: 10px; z-index: 1050; max-width: 400px;">
        @TempData["SuccessMessage"]
    </div>

    <style>
        #successToast {
            animation: slideIn 0.5s ease-out;
        }

        #successToast.hide {
            animation: fadeOut 0.5s ease forwards;
        }

        @@keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @@keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
    </style>

    <script>
        setTimeout(function () {
            var toast = document.getElementById('successToast');
            if (toast) {
                toast.classList.add('hide');
                setTimeout(() => toast.remove(), 500);
            }
        }, 3000);
    </script>
}



    <div class="profile-card">

        <div class="avatar-wrapper">
            <img src="@avatarUrl" alt="Avatar" />
            <div class="avatar-overlay">
                <i class="fa fa-pen"></i>
                <span>Edit</span>
            </div>
            <form asp-action="UploadAvatar" asp-controller="Account" method="post" enctype="multipart/form-data"
                id="avatarForm">
                <input type="file" name="avatar" id="avatarInput" accept="image/*" style="display:none;" />
            </form>
        </div>


        <div class="profile-info">
            <h4>@(Model.Name ?? "Người dùng")</h4>

            <div class="info-item"><i class="fa fa-envelope"></i> <strong>Email:</strong> @(Model.Email ?? "-")</div>
            <div class="info-item"><i class="fa fa-phone"></i> <strong>Số điện thoại:</strong> @(Model.Phone ?? "-")
            </div>
            <div class="info-item"><i class="fa fa-birthday-cake"></i> <strong>Ngày sinh:</strong>
                @(Model.BirthDate?.ToString("dd/MM/yyyy") ?? "-")</div>
            <div class="info-item"><i class="fa fa-home"></i> <strong>Địa chỉ:</strong> @(Model.Address ?? "-")</div>


            <div class="profile-actions">
                <a asp-controller="Account" asp-action="EditProfile" class="btn btn-danger">Chỉnh sửa</a>
            </div>
        </div>
    </div>
</div>



@section Scripts {
    <script>

        document.querySelectorAll('.avatar-wrapper').forEach(wrapper => {
            const overlay = wrapper.querySelector('.avatar-overlay');
            wrapper.addEventListener('mouseenter', () => overlay.style.opacity = 1);
            wrapper.addEventListener('mouseleave', () => overlay.style.opacity = 0);


            overlay.addEventListener('click', () => {
                wrapper.querySelector('#avatarInput').click();
            });


            wrapper.querySelector('#avatarInput').addEventListener('change', () => {
                wrapper.querySelector('#avatarForm').submit();
            });
        });

    </script>


}